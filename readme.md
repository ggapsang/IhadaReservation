# 예약 관리 시스템 (Apps Script WebApp)

Google Apps Script 기반의 실시간 예약 관리 시스템

## 시스템 구조

```
Google Site (iframe) → Apps Script WebApp → Google Spreadsheet → Kakao API
                                          ↓
                                   Google Calendar
```

## 주요 기능

### 1. 예약 입력 폼

**텍스트 입력**
- 업체 및 브랜드명
- 인스타그램 ID
- 이름
- 연락처
- 전체 인원
- 방문 차량 대수

**날짜/시간 선택**
- 예약 날짜 (캘린더 UI)
- 시작 시간 (30분 단위)
- 종료 시간 (30분 단위)

**선택 옵션**
- Room 타입 (드롭다운 4개)
- 세금계산서 발행 여부
- 유입 경로 (네이버, 인스타그램, 지인소개, 공간플랫폼, 기타)
- 촬영 내용 (의류, 광고, 드라마, 잡지, 스냅, 기타)

**파일 업로드**
- 사업자등록증 (10MB 이내)

**약관 동의**
- 이용 약관 체크박스

### 2. 실시간 가격 계산 로직

**기본 요금 정책**
```
룸당 기준 인원: 3명
기본 요금: 44,000원/시간
최소 이용 시간: 2시간
추가 인원 요금: 5,000원/인
```

**계산 규칙**
- 3명까지: 기본요금 × 이용시간
- 3명 초과: (기본요금 + 추가인원 × 5,000원) × 이용시간
- 10명 이상: A+B 룸 동시 대관 자동 선택
- VAT 10% 자동 반영

**실시간 반영**
- 인원 입력 시 → Room 타입 자동 선택
- 시간 선택 시 → 총 비용 실시간 계산 및 표시

### 3. 예약 중복 방지

- 제출 전 예약 가능 여부 즉시 확인
- 선택한 날짜/시간/룸의 예약 현황 실시간 체크

### 4. 자동 알림 시스템

**카카오톡 알림톡 발송**
- 예약 확정 메시지 (즉시 발송)
- 입실 30분 전 안내 메시지 (예약 발송)
- 퇴실 30분 전 안내 메시지 (예약 발송)

### 5. 관리자 기능

**Google Spreadsheet 기반**
- 예약 신청 내역 자동 저장
- 입금 확인 체크박스
- 입금 확인 시 Google Calendar 자동 업데이트

**정책 설정 변경 가능**
- 룸당 기준 인원
- 시간당 단가
- 추가 인원 단가
- A+B 동시 대관 기준 인원

## 기술 스택

- Google Apps Script
- Google Spreadsheet
- Google Calendar
- Kakao Talk API
- HTML/CSS/JavaScript (WebApp UI)

## 스프레드시트 설정

시스템 운영을 위해 다음 시트들을 생성해야 합니다:

### 1. 설정 시트
```
A1: 항목명        | B1: 값
A2: 기준인원      | B2: 3
A3: 시간당기본요금 | B3: 44000
A4: 최소이용시간   | B4: 2
A5: 추가인원단가   | B5: 5000
A6: AB동시대관기준 | B6: 10
A7: VAT요율      | B7: 10
```

### 2. Room정보 시트
```
A1: Room타입 | B1: 수용인원 | C1: 시간당요금 | D1: 설명 | E1: 활성화
A2: A       | B2: 8       | C2: 44000    | D2: 메인 스튜디오 A | E2: Y
A3: B       | B3: 8       | C3: 44000    | D3: 메인 스튜디오 B | E3: Y
A4: C       | B4: 5       | C4: 44000    | D4: 소형 스튜디오 C | E4: Y
A5: D       | B5: 5       | C5: 44000    | D5: 소형 스튜디오 D | E5: Y
A6: A+B     | B6: 16      | C6: 88000    | D6: A+B 동시 대관  | E6: Y
```

### 3. 예약내역 시트
첫 행에 다음 헤더를 입력하세요:
```
예약번호 | 신청일시 | 예약날짜 | 시작시간 | 종료시간 | 이용시간 | Room타입 | 업체명 | 인스타그램ID | 이름 | 연락처 | 전체인원 | 차량대수 | 세금계산서 | 유입경로 | 촬영내용 | 기본요금 | 추가인원요금 | 소계 | VAT | 총금액 | 입금확인 | 입금확인일시 | 사업자등록증 | Calendar이벤트ID | 알림톡발송상태 | 비고
```

### 4. 예약현황로그 시트 (통계/분석용)
첫 행에 다음 헤더를 입력하세요:
```
조회일시 | Room타입 | 예약날짜 | 시작시간 | 종료시간 | 가능여부
```

**용도:**
- 사용자들의 예약 가능 여부 조회 기록 자동 저장
- 인기 시간대 및 수요 패턴 분석
- 조회 대비 실제 예약 전환율 분석
- 마케팅 전략 수립 데이터

### 5. 알림톡템플릿 시트 (선택사항)
카카오 알림톡 기능 사용 시 생성:
```
템플릿명 | 템플릿코드 | 발송시점 | 메시지내용
```

## 배포 방식

### 1. Apps Script 배포
1. Google Apps Script 에디터에서 "배포" → "새 배포" 클릭
2. 유형: 웹 앱 선택
3. 실행 계정: 나
4. 액세스 권한: 모든 사용자
5. 배포 URL 복사

### 2. Google Site 임베드 (선택사항)
- Google Site에서 "삽입" → "URL"
- 배포 URL 입력하여 iframe으로 임베드

### 3. Google Docs 약관 연동
- Google Docs에서 이용약관 문서 작성
- 문서 ID를 Code.gs의 `getTermsContent()` 함수에 설정
- 약관 수정 시 Docs만 편집하면 자동 반영
